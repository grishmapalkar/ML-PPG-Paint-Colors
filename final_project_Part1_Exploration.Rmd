---
title: "PPG Paint Colors: Final Project"
subtitle: "Example: read data, save, and reload model object"
author: "Grishma Palkar"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overview

This RMarkdown shows how to read in the final project data. It also shows how to calculate the logit-transformed response and setup the binary outcome for use with `caret` or `tidymodels`. It also demonstrates how to fit a simple model (with `lm()`), save that model, and load it back into the workspace. You may find these actions helpful as you work through the project.  

**You must download the data from Canvas and save the data in the same directory as this RMarkdown file.**  

## Load packages

This example uses the `tidyverse` suite of packages.  

```{r, load_tidyverse}
library(tidyverse)
```

## Read data

Please download the final project data from Canvas. If this Rmarkdown file is located in the same directory as the downloaded CSV file, it will be able to load in the data for you. It is **highly** recommended that you use an RStudio RProject to easily manage the working directory and file paths of the code and objects associated with the final project.  

The code chunk below reads in the final project data.  

```{r, read_final_data}
df <- readr::read_csv("paint_project_train_data.csv", col_names = TRUE)
```

The `readr::read_csv()` function displays the data types and column names associated with the data. However, a glimpse is shown below that reveals the number of rows and also shows some of the representative values for the columns.  

```{r, show_data_glimpse}
df %>% glimpse()
```

The data consist of continuous and categorical inputs. The `glimpse()` shown above reveals the data type for each variable which state to you whether the input is continuous or categorical. The RGB color model inputs, `R`, `G`, and `B` are continuous (dbl) inputs. The HSL color model inputs consist of 2 categorical inputs, `Lightness` and `Saturation`, and a continuous input, `Hue`. Two outputs are provided. The continuous output, `response`, and the Binary output, `outcome`. However, the data type of the Binary outcome is numeric because the Binary `outcome` is **encoded** as `outcome = 1` for the EVENT and `outcome = 0` for the NON-EVENT.  

```{r, make_reg_data}
dfii <- df %>% 
  mutate(y = boot::logit( (response - 0) / (100 - 0) ) ) %>% 
  select(R, G, B, 
         Lightness, Saturation, Hue,
         y)

dfii %>% glimpse()
```

## Part 1-Exploration

##1) Visualize the distributions of variables in the data set.
• Counts for categorical variables.

````{r,1a}
df %>% 
  ggplot(mapping=aes(x = Lightness)) +
  geom_bar()

df %>% 
  ggplot(mapping=aes(x = Saturation)) +
  geom_bar()

````

• Histograms or Density plots for continuous variables.
````{r,1b}
lf <- df %>% 
  tibble::rowid_to_column() %>% 
  pivot_longer(c(R, G,B,Hue))

lf%>%ggplot(aes(x = value)) +
  geom_histogram() +
  facet_wrap(~ name, scales = "free_x")
````
 Are the distributions Gaussian like?
 Ans. No, the distribution is not like Gaussian because it is not symmetric.
 
 ##(2) Condition (group) the continuous variables based on the categorical variables.
• Are there differences in continuous variable distributions and continuous variable summary
statistics based on categorical variable values? 
````{r,2a}
lf%>%ggplot(aes(x = Lightness, y = value)) +
  geom_boxplot() +
  facet_wrap(~ name)

lf%>%ggplot(aes(x = Saturation, y = value)) +
  geom_boxplot() +
  facet_wrap(~ name)


````
From the above plots, we observe differences in continuous variable distributions and continuous variable summary statistics based on categorical variable values.

• Are there differences in continuous variable distributions and continuous variable summary
statistics based on the binary outcome?
````{r,2b}
df %>% ggplot(aes(x=outcome))+
   geom_bar()
````

The binary outcome is not balanced. Number of non-events are more than number of events. Hence, there is differences in continuous variable distributions and continuous variable summary statistics based on the binary outcome.

##(3) Visualize the relationships between the continuous inputs, are they correlated?
````{r,3}

df %>% 
  select(-response) %>% select(-outcome)%>% select(-Lightness) %>%select(-Saturation) %>%
  cor() %>% 
  corrplot::corrplot(method = "number", type = "upper")


````
We clearly see that the continuous inputs are correlated from the above figures.


##(4) Visualize the relationships between the continuous output response with respect to the continuous INPUTS.
````{r,4a}
df %>% ggplot(aes(x=R,y=response))+
  geom_point()+
  labs(x="Red",y="Response")

df %>% ggplot(aes(x=G,y=response))+
  geom_point()+
   labs(x="Green",y="Response")

df %>% ggplot(aes(x=B,y=response))+
  geom_point()+
   labs(x="Blue",y="Response")

df %>% ggplot(aes(x=Hue,y=response))+
  geom_point()+
   labs(x="Hue",y="Response")

````
Visualize the relationships between the continuous output LOGIT-transformed response with respect to the continuous INPUTS.
```{r, 4b}
dfii %>% ggplot(aes(x=R,y=y))+
  geom_point()+
  labs(x="Red",y="LOGIT-transformed response")

dfii %>% ggplot(aes(x=G,y=y))+
  geom_point()+
  labs(x="Green",y="LOGIT-transformed response")

dfii %>% ggplot(aes(x=B,y=y))+
  geom_point()+
  labs(x="Blue",y="LOGIT-transformed response")

dfii %>% ggplot(aes(x=Hue,y=y))+
  geom_point()+
  labs(x="Hue",y="LOGIT-transformed response")
  
```
Can you identify any clear trends? 
Ans. We can observe that the continuous output response and LOGIT-transformed response increases as the continuous input G increases(linearly). But for Hue we don't observe any clear trend. For continuous input R and B we see a trend that the continuous output response and LOGIT-transformed response increases with R and B, but the trend is not very clear as the data is scattered.

Do the trends depend on the categorical INPUTS?
Ans. No


##(5) How can you visualize the behavior of the binary outcome with respect to the continuous inputs? 
````{r,5a}
lf%>%ggplot(aes(x=value,y=outcome))+
geom_jitter(height = 0.02, width = 0) +
  facet_wrap(~ name)
````
From these plots, we can see that there may be some differences in the distribution of the binary outcome across the range of values for each continuous input variable. However, further analysis is needed to determine if these differences are statistically significant.


How can you visualize the behavior of the binary outcome with respect to the categorical INPUTS?
````{r,5b}
df%>%ggplot(aes(x = Lightness)) +
  geom_bar(aes(fill=as.factor(outcome)))

df%>%ggplot(aes(x = Saturation)) +
  geom_bar(aes(fill=as.factor(outcome)))

```
We observe for Lightness that each category(dark to soft) has higher number of count for non-events than events.
We observe for Saturation that category gray has much higher count for event than non-events. Bright has very high number of counts fro non-events than events. Also, the remaining categories has higher number of counts for non-events than events.